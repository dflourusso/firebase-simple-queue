module.exports=function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r(r.s=1)}([function(t,e,r){t.exports=r(3)},function(t,e,r){t.exports=r(2)},function(t,e,r){"use strict";r.r(e);var n=r(0),o=r.n(n);function u(t,e,r,n,o,u,a){try{var c=t[u](a),i=c.value}catch(t){return void r(t)}c.done?e(i):Promise.resolve(i).then(n,o)}function a(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var a=t.apply(e,r);function c(t){u(a,n,o,c,i,"next",t)}function i(t){u(a,n,o,c,i,"throw",t)}c(void 0)})}}function c(t){var e="Error to process the task";return"[object Error]"===Object.prototype.toString.call(t)?e=t.message:"[object String]"===Object.prototype.toString.call(t)?e=t:void 0!==t&&null!==t&&(e=JSON.stringify(t)),{message:e,stack:t.stack||null}}e.default=function(t,e,r,n){var u=e.database().ref(r);function i(t){return s.apply(this,arguments)}function s(){return(s=a(o.a.mark(function t(e){var r,a,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",!1);case 2:return r=e.id,a=e.task,t.next=5,new Promise(function(t){return u.child("current").transaction(function(e){var n=e||r;return t(n),n})});case 5:if(t.sent==r){t.next=8;break}return t.abrupt("return",!1);case 8:return i={current:null},t.prev=9,t.next=12,n(a);case 12:i["tasks/".concat(r)]=null,t.next=19;break;case 15:t.prev=15,t.t0=t.catch(9),console.log("ERROR",t.t0),i["tasks/".concat(r,"/_error")]=c(t.t0);case 19:return t.next=21,u.update(i);case 21:return t.abrupt("return",!0);case 22:case"end":return t.stop()}},t,this,[[9,15]])}))).apply(this,arguments)}function f(){return l.apply(this,arguments)}function l(){return(l=a(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=i,t.next=3,u.child("tasks").orderByChild("_error").equalTo(null).limitToFirst(1).once("value").then(function(t){return t.val()}).then(function(t){if(!t)return null;var e=Object.keys(t).pop();return{id:e,task:t[e]}});case 3:return t.t1=t.sent,t.next=6,(0,t.t0)(t.t1);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}return{onCreateTask:t.database.ref("/".concat(r,"/tasks/{id}")).onCreate(f),onFinishTask:t.database.ref("/".concat(r,"/current")).onDelete(f),onRetryTask:t.database.ref("/".concat(r,"/tasks/{id}/_error")).onDelete(f)}}},function(t,e){t.exports=require("regenerator-runtime")}]);